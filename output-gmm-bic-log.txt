gcc gmm-bic-log.c -lm -o gmm-bic-log

gmm-bic-log 3 749 oil.dat
Number of clusters wanted: 3.
Number of input data values: 749.
Check on first 10 values of input data:
 17.4 17.5 17.7 17.7 17.4 17.4 17.7 17.7 17.5 17.9
Min and max values =  -0.091199, 0.094076
Greyscale histogram follows, 256 values.
1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 1 1 0 0 0 1 0 1 2 0 1 0 1 0 0 0 1 0 0 0 0 0 0 1 1 0 1 0 1 1 2 1 4 1 2 2 3 4 3 4 3 1 2 2 3 4 3 2 2 1 1 2 1 2 3 3 1 3 3 1 9 8 6 9 5 7 3 9 4 12 3 9 12 10 5 9 13 11 9 18 14 15 12 21 15 20 35 8 14 13 18 10 11 16 19 14 13 7 9 12 8 9 11 8 6 8 9 10 12 7 11 4 4 5 6 3 3 2 6 1 4 3 3 0 3 3 2 5 0 6 0 3 2 2 2 1 2 1 1 2 0 0 1 0 1 1 1 1 1 2 0 0 0 1 0 1 2 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 1 
Convergence criterion  0.007480 

Loglikelihood:             -3476.237524 
BIC:          -7005         No.clusters: 3 

Now determining posteriors, for each pixel.
Labels are 1, 2, ... no. clusters.
Segment,  Mu,       SD, Mix.Prob, Card.
1, -0.001624, 0.025252, 0.360284,  224
2, 0.001032, 0.007539, 0.452290,  489
3, -0.000333, 0.056698, 0.187425,  35
Labels follow, n values.
2 2 2 1 2 1 2 2 1 1 1 2 2 1 2 2 2 1 2 1 2 2 2 2 2 2 2 2 2 2 2 2 1 2 2 2 2 2 2 2 2 2 2 2 1 1 2 2 1 2 2 2 2 2 1 2 2 2 2 2 2 2 2 2 1 2 2 2 2 1 1 2 1 2 1 2 2 1 2 2 2 2 2 1 3 3 2 2 1 2 1 2 1 2 2 2 2 2 2 1 2 1 2 2 2 2 2 2 2 2 1 2 2 2 2 2 2 1 2 1 2 2 2 2 2 1 2 2 2 2 2 1 2 2 2 1 2 2 2 2 1 1 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 1 2 2 2 2 1 2 1 2 2 2 2 2 2 2 2 1 2 2 2 2 2 2 1 2 2 2 1 3 1 2 2 2 2 2 2 2 1 1 2 2 2 2 2 1 2 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 2 2 2 2 1 2 2 2 2 2 2 2 2 2 1 2 2 2 1 2 1 2 2 2 2 2 2 2 2 2 2 2 2 1 2 1 1 3 1 2 1 1 1 2 1 1 2 1 2 1 2 2 2 2 1 2 2 2 2 2 3 2 2 2 2 3 3 2 1 1 2 1 2 2 2 1 1 1 2 2 1 2 1 3 3 3 3 3 3 1 2 1 1 2 1 1 1 1 2 2 2 3 3 1 1 1 2 1 2 2 3 1 2 2 2 3 1 2 2 2 2 2 1 2 1 2 2 1 2 3 2 3 2 2 2 2 1 1 2 2 1 1 1 2 2 2 2 2 1 3 1 1 2 1 2 2 1 1 2 1 1 2 2 2 2 2 2 1 2 1 2 1 2 1 1 1 1 2 1 2 2 2 1 2 2 2 2 2 2 1 2 2 2 1 3 1 3 1 1 1 2 2 1 2 2 3 2 2 1 2 2 1 2 1 3 2 1 1 2 2 1 2 2 1 2 2 2 1 2 1 2 1 1 1 3 2 2 2 2 1 1 2 2 1 2 1 1 2 2 2 2 1 2 2 1 2 2 2 1 1 2 2 2 2 2 2 2 3 2 2 1 2 2 1 3 2 1 3 2 1 2 3 2 2 2 2 2 2 1 2 2 2 1 2 2 2 2 2 2 2 1 2 1 1 2 2 1 1 2 2 2 2 1 2 1 2 2 2 1 1 2 2 1 2 1 2 2 2 1 1 1 2 2 2 1 2 1 2 1 2 1 1 1 2 1 1 3 2 2 1 1 2 1 2 2 1 2 1 2 1 2 2 2 2 2 1 2 1 2 1 1 1 2 2 2 2 1 2 2 2 1 2 3 2 2 2 3 1 1 1 2 2 2 1 2 2 2 2 1 2 1 3 2 2 2 2 2 2 2 1 2 2 1 2 1 1 1 1 2 2 1 2 2 2 1 2 2 1 1 2 1 1 2 2 1 2 2 2 2 1 3 1 1 2 1 1 1 2 2 2 2 2 2 2 2 1 2 1 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 1 2 2 2 2 2 2 1 1 1 2 2 1 3 1 2 2 2 2 1 1 2 1 1 2 2 1 1 2 2 1 2 1 2 2 2 1 2 1 1 2 2 2 2 1 2 2 
Finished.
